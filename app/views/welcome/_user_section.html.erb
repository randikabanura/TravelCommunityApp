<script>
    function isfollowing(current_user_id, follow_user) {
        var value;
        $.post("api/v1/isfollowing", {
            current_user_id: current_user_id,
            follow_user_id: follow_user.id
        }, function (data, status) {
            if(data.data == true)
                value = "Unfollow"
            else
                value = "Follow"
            console.log(value)
            $('#user_list').append('<div class="single_user"><div class="card border-dark mb-3" style="min-width: 16rem;">\n' +
                '  <div class="card-body text-dark" data-userid="<%= current_user.id %>">\n' +
                '    <h5 class="card-title">' + follow_user.name + '</h5>\n' +
                '    <button type="button" id='+ follow_user.id+' class="btn btn-primary submit user_btn">'+ value +'</button>\n' +
                '  </div>\n' +
                '</div></div>')
        })
    }
    var url = "/api/v1/users";
    $.get(url, function (data, status) {
        $.each(data.data, function (i, item) {
            isfollowing($('#user_list').attr("data-userid"), item)
        });
    });

</script>

<div id="user_list" data-userid="<%= current_user.id %>">
  <h3>Users List</h3>
</div>